<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SkyCast â€” Live Weather</title>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' stop-color='%233b82f6'/><stop offset='100%25' stop-color='%238b5cf6'/></linearGradient></defs><rect width='64' height='64' rx='14' fill='url(%23g)'/><circle cx='42' cy='22' r='8' fill='%23fbbf24'/><line x1='42' y1='10' x2='42' y2='7' stroke='%23fbbf24' stroke-width='2' stroke-linecap='round'/><line x1='42' y1='37' x2='42' y2='34' stroke='%23fbbf24' stroke-width='2' stroke-linecap='round'/><line x1='30' y1='22' x2='27' y2='22' stroke='%23fbbf24' stroke-width='2' stroke-linecap='round'/><line x1='57' y1='22' x2='54' y2='22' stroke='%23fbbf24' stroke-width='2' stroke-linecap='round'/><ellipse cx='28' cy='36' rx='14' ry='10' fill='white' opacity='.95'/><ellipse cx='42' cy='40' rx='16' ry='11' fill='white'/><ellipse cx='20' cy='40' rx='10' ry='8' fill='white' opacity='.9'/></svg>">
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   THEME VARIABLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --navbar-h: 60px;
  --accent-blue:   #3b82f6;
  --accent-purple: #8b5cf6;
  --accent-orange: #f97316;
  --accent-green:  #22c55e;
  --accent-yellow: #eab308;
  --radius-card: 16px;
  --transition: .3s ease;
}

/* DARK */
[data-theme="dark"] {
  --bg-body:    #0d0f14;
  --bg-card:    #161922;
  --bg-card2:   #1c2030;
  --bg-card3:   #131620;
  --bg-main-card: linear-gradient(150deg,#1a1e2c 0%,#101318 100%);
  --bg-navbar:  rgba(13,15,20,0.9);
  --bg-input:   rgba(255,255,255,0.07);
  --bg-btn:     rgba(255,255,255,0.06);
  --text-1:     #f1f5f9;
  --text-2:     #94a3b8;
  --text-3:     #64748b;
  --border:     rgba(255,255,255,0.07);
  --border2:    rgba(255,255,255,0.11);
  --shadow:     0 16px 48px rgba(0,0,0,0.55);
  --sug-bg:     #141720;
  --aqi-base:   #161922;
  --spinner-border: rgba(255,255,255,0.08);
  --card-shine: linear-gradient(135deg,rgba(255,255,255,.02) 0%,transparent 60%);
}

/* LIGHT */
[data-theme="light"] {
  --bg-body:    #eef2f7;
  --bg-card:    #ffffff;
  --bg-card2:   #f8fafc;
  --bg-card3:   #f1f5f9;
  --bg-main-card: linear-gradient(150deg,#d6e4f7 0%,#e8f0fa 100%);
  --bg-navbar:  rgba(238,242,247,0.94);
  --bg-input:   rgba(0,0,0,0.05);
  --bg-btn:     rgba(0,0,0,0.06);
  --text-1:     #0f172a;
  --text-2:     #475569;
  --text-3:     #94a3b8;
  --border:     rgba(0,0,0,0.08);
  --border2:    rgba(0,0,0,0.12);
  --shadow:     0 8px 30px rgba(0,0,0,0.1);
  --sug-bg:     #ffffff;
  --aqi-base:   #ffffff;
  --spinner-border: rgba(0,0,0,0.08);
  --card-shine: none;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: 'Outfit', sans-serif;
  background: var(--bg-body);
  color: var(--text-1);
  min-height: 100vh;
  padding: calc(var(--navbar-h) + 14px) 14px 0;
  transition: background var(--transition), color var(--transition);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAVBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.navbar {
  position: fixed; top:0; left:0; right:0;
  height: var(--navbar-h);
  z-index: 500;
  background: var(--bg-navbar);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border-bottom: 1px solid var(--border);
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  padding: 0 20px;
  gap: 12px;
  transition: background var(--transition), border-color var(--transition);
}

/* Logo */
.nav-logo {
  display: flex; align-items: center; gap: 9px;
  text-decoration: none; user-select: none; justify-self: start;
}
.logo-icon {
  width:36px; height:36px; border-radius:10px;
  background: linear-gradient(135deg,#3b82f6,#8b5cf6);
  display:flex; align-items:center; justify-content:center;
  box-shadow: 0 0 16px rgba(59,130,246,0.35);
  flex-shrink:0;
}
.logo-text {
  font-size:21px; font-weight:700; letter-spacing:-0.5px;
  color: var(--text-1);
  transition: color var(--transition);
}
.logo-text .blue {
  background: linear-gradient(135deg,#3b82f6,#8b5cf6);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
}
.logo-badge {
  font-size:9px; font-weight:600; letter-spacing:1.2px;
  color: var(--accent-blue);
  background: rgba(59,130,246,0.12);
  border: 1px solid rgba(59,130,246,0.28);
  border-radius:4px; padding:2px 5px;
  text-transform:uppercase; align-self:flex-end; margin-bottom:3px;
}

/* Search â€” centre column */
.nav-search-wrap {
  width:100%; max-width:520px;
  position:relative; justify-self:center;
}
.nav-search-bar {
  width:100%;
  background: var(--bg-input);
  border: 1px solid var(--border2);
  border-radius:28px;
  color: var(--text-1);
  font-family:'Outfit',sans-serif; font-size:13px;
  padding: 10px 94px 10px 42px;
  outline:none;
  transition: border-color .2s, background .2s, box-shadow .2s;
}
.nav-search-bar::placeholder { color: var(--text-3); }
.nav-search-bar:focus {
  border-color: rgba(59,130,246,.55);
  background: var(--bg-input);
  box-shadow: 0 0 0 3px rgba(59,130,246,0.12);
}
.nav-search-icon {
  position:absolute; left:14px; top:50%; transform:translateY(-50%);
  font-size:14px; pointer-events:none; opacity:.4;
}
.nav-search-btn {
  position:absolute; right:5px; top:50%; transform:translateY(-50%);
  background: linear-gradient(135deg,#3b82f6,#6366f1);
  border:none; border-radius:22px; color:#fff;
  font-family:'Outfit',sans-serif; font-size:12px; font-weight:600;
  padding:7px 16px; cursor:pointer;
  transition: opacity .2s, transform .15s;
  white-space:nowrap;
}
.nav-search-btn:hover { opacity:.88; transform:translateY(-50%) scale(1.03); }
.nav-search-clear {
  position:absolute; right:78px; top:50%; transform:translateY(-50%);
  background:none; border:none; color:var(--text-3); font-size:14px;
  cursor:pointer; padding:2px 4px; display:none;
  transition: color .2s;
}
.nav-search-clear:hover { color:var(--text-1); }

/* Suggestions */
.nav-suggestions {
  position:absolute; top:calc(100% + 8px); left:0; right:0;
  background: var(--sug-bg);
  border: 1px solid var(--border2);
  border-radius:14px; overflow:hidden;
  z-index:600;
  box-shadow: var(--shadow);
  display:none;
  max-height:270px; overflow-y:auto;
  transition: background var(--transition);
}
.nav-suggestions.open { display:block; }
.sug-item {
  display:flex; align-items:center; gap:10px;
  padding:11px 16px; cursor:pointer;
  border-bottom:1px solid var(--border);
  transition: background .15s;
}
.sug-item:last-child { border-bottom:none; }
.sug-item:hover, .sug-item.focused { background:rgba(59,130,246,.1); }
.sug-main { font-size:13px; font-weight:500; color:var(--text-1); }
.sug-sub { font-size:11px; color:var(--text-3); margin-top:1px; }
.sug-country {
  margin-left:auto; font-size:10px;
  background:var(--border); border-radius:5px; padding:2px 7px;
  color:var(--text-2); flex-shrink:0;
}
.sug-empty { padding:16px; text-align:center; font-size:12px; color:var(--text-3); }
.sug-loading {
  padding:16px; text-align:center; font-size:12px; color:var(--text-2);
  display:flex; align-items:center; justify-content:center; gap:8px;
}
.sug-spin {
  width:13px; height:13px;
  border:2px solid var(--spinner-border);
  border-top-color:var(--accent-blue);
  border-radius:50%; animation:spin .65s linear infinite;
}

/* Nav right */
.nav-right {
  display:flex; align-items:center; gap:9px; justify-self:end;
}
.nav-time {
  font-family:'JetBrains Mono',monospace;
  font-size:12px; color:var(--text-2);
  background:var(--bg-btn); border:1px solid var(--border);
  border-radius:8px; padding:6px 11px;
  min-width:90px; text-align:center;
  transition: background var(--transition), color var(--transition);
}
.theme-btn {
  display:flex; align-items:center; gap:6px;
  background:var(--bg-btn); border:1px solid var(--border2);
  border-radius:22px; padding:7px 13px;
  cursor:pointer; color:var(--text-2);
  font-family:'Outfit',sans-serif; font-size:12px; font-weight:500;
  transition: background .2s, border-color .2s, color .2s, transform .15s;
  white-space:nowrap;
}
.theme-btn:hover {
  background:rgba(59,130,246,.1); border-color:rgba(59,130,246,.35);
  color:var(--accent-blue); transform:scale(1.04);
}
.theme-btn .ico { font-size:15px; line-height:1; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DASHBOARD GRID
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.dashboard {
  max-width:1380px; margin:0 auto;
  display:grid;
  grid-template-columns: 310px 1fr 210px;
  grid-template-rows: auto auto auto;
  gap:10px;
}

/* â”€â”€ CARD BASE â”€â”€ */
.card {
  background: var(--bg-card);
  border-radius: var(--radius-card);
  border: 1px solid var(--border);
  padding:18px;
  position:relative; overflow:hidden;
  transition: background var(--transition), border-color var(--transition);
}
.card::before {
  content:''; position:absolute; inset:0;
  background: var(--card-shine); pointer-events:none;
}

/* â”€â”€ MAIN CARD â”€â”€ */
.main-card {
  grid-column:1; grid-row:1/3;
  background: var(--bg-main-card);
  padding:22px;
  transition: background var(--transition);
}
.main-header { margin-bottom:12px; }
.loc-row { display:flex; align-items:center; gap:6px; }
.loc-pin { color:var(--accent-orange); font-size:14px; }
.loc-name { font-size:15px; font-weight:600; color:var(--text-1); }
.updated { font-size:11px; color:var(--text-3); margin-top:3px;
  transition: color var(--transition); }

.weather-vis {
  display:flex; align-items:center; gap:14px;
  margin:18px 0 6px; position:relative;
}
.wi-main {
  font-size:78px; line-height:1;
  animation:float 3s ease-in-out infinite;
  filter:drop-shadow(0 0 20px rgba(255,200,50,.4));
}
.wi-main.night { filter:drop-shadow(0 0 20px rgba(160,190,255,.45)); }
@keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-8px)} }

.temp-big { font-size:58px; font-weight:700; letter-spacing:-3px; line-height:1; }
.desc-txt { font-size:14px; color:var(--text-2); margin-top:4px;
  text-transform:capitalize; transition:color var(--transition); }
.feels-txt { font-size:11px; color:var(--text-3); margin-top:3px;
  transition:color var(--transition); }

.dots {
  position:absolute; right:-4px; top:50%; transform:translateY(-50%);
  display:flex; flex-direction:column; gap:6px;
}
.dot { width:7px; height:7px; border-radius:50%; }
.dot-o{background:var(--accent-orange);}
.dot-b{background:var(--accent-blue);}
.dot-p{background:var(--accent-purple);}
.dot-e{border:1.5px solid var(--text-3); background:transparent;}

/* Quick-switch tabs */
.city-tabs { display:flex; gap:7px; margin-top:20px; }
.ctab {
  flex:1; background:rgba(255,255,255,0.05);
  border-radius:10px; padding:9px 11px;
  cursor:pointer; border:1px solid transparent;
  transition:all .2s;
}
[data-theme="light"] .ctab { background:rgba(0,0,0,0.04); }
.ctab:hover { background:rgba(255,255,255,0.09); }
[data-theme="light"] .ctab:hover { background:rgba(0,0,0,0.07); }
.ctab.active {
  background:rgba(59,130,246,0.12);
  border-color:rgba(59,130,246,0.3);
}
.ctab-name { font-size:10px; color:var(--text-2); margin-bottom:3px; }
.ctab-tmp { font-size:14px; font-weight:600; color:var(--text-1); }

/* â”€â”€ FORECAST ROW â”€â”€ */
.fc-row { grid-column:2/4; grid-row:1; display:flex; gap:7px; }
.fc-day {
  flex:1; background:var(--bg-card); border-radius:13px;
  border:1px solid var(--border); padding:12px 8px;
  text-align:center; cursor:pointer;
  transition: background .2s, border-color .2s, transform .15s;
}
.fc-day:hover, .fc-day.active {
  background:var(--bg-card2); border-color:var(--border2);
  transform:translateY(-2px);
}
.fc-icon { font-size:24px; margin-bottom:5px; display:block; }
.fc-name { font-size:10px; color:var(--text-2); margin-bottom:2px; }
.fc-tmp { font-size:13px; font-weight:600; }
.fc-lo { font-size:10px; color:var(--text-3); }

/* â”€â”€ CHART â”€â”€ */
.chart-card { grid-column:2; grid-row:2; }
.sec-title { font-size:13px; font-weight:600; color:var(--text-2); margin-bottom:14px;
  transition:color var(--transition); }
.chart-wrap { position:relative; height:148px; }

/* â”€â”€ SUNRISE / SUNSET â”€â”€ */
.sun-card { grid-column:3; grid-row:2; display:flex; flex-direction:column; justify-content:center; gap:18px; }
.sun-title { font-size:13px; font-weight:600; color:var(--text-2); margin-bottom:4px;
  transition:color var(--transition); }
.sun-item { display:flex; align-items:center; gap:10px; }
.sun-ico { font-size:26px; }
.sun-lbl { font-size:10px; color:var(--text-3); transition:color var(--transition); }
.sun-time { font-size:17px; font-weight:600; font-family:'JetBrains Mono',monospace; }

/* â”€â”€ STATS GRID â”€â”€ */
.stats-grid { grid-column:1; grid-row:3; display:grid; grid-template-columns:1fr 1fr; gap:8px; }
.stat-c {
  background:var(--bg-card); border-radius:13px;
  border:1px solid var(--border); padding:14px;
  transition:background var(--transition), border-color var(--transition);
}
.stat-lbl { display:flex; align-items:center; gap:5px; font-size:11px; color:var(--text-2);
  margin-bottom:6px; transition:color var(--transition); }
.stat-ico { font-size:13px; }
.stat-val { font-size:19px; font-weight:700; color:var(--text-1); }
.stat-u { font-size:11px; color:var(--text-3); font-weight:400; transition:color var(--transition); }

/* â”€â”€ AQI â”€â”€ */
.aqi-card { grid-column:2; grid-row:3; display:grid; grid-template-columns:1fr 1fr; padding:0; overflow:hidden; }
.aqi-l { padding:18px; display:flex; flex-direction:column; align-items:center; border-right:1px solid var(--border); }
.aqi-t { font-size:13px; font-weight:600; color:var(--text-2); margin-bottom:14px; align-self:flex-start;
  transition:color var(--transition); }
.aqi-ring {
  width:110px; height:110px; border-radius:50%;
  border:3.5px solid transparent;
  background:linear-gradient(var(--aqi-base),var(--aqi-base)) padding-box,
             linear-gradient(135deg,#22c55e,#16a34a) border-box;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  box-shadow:0 0 28px rgba(34,197,94,.2);
  animation:glow-pulse 2.5s ease-in-out infinite;
}
@keyframes glow-pulse { 0%,100%{opacity:.78} 50%{opacity:1} }
.aqi-status { font-size:12px; color:var(--accent-green); font-weight:500; }
.aqi-num { font-size:28px; font-weight:700; color:var(--accent-green); }
.aqi-cap { font-size:10px; color:var(--text-3); margin-top:8px; text-align:center;
  transition:color var(--transition); }
.aqi-r { padding:18px; display:grid; grid-template-columns:1fr 1fr; gap:10px; align-content:center; }
.aqi-s-hd { display:flex; align-items:center; gap:4px; margin-bottom:1px; }
.aqi-dot { width:7px; height:7px; border-radius:50%; }
.aqi-s-nm { font-size:10px; color:var(--text-3); transition:color var(--transition); }
.aqi-s-v { font-size:20px; font-weight:700; color:var(--text-1); }

/* â”€â”€ RAIN â”€â”€ */
.rain-card { grid-column:3; grid-row:3; }
.rain-title { font-size:13px; font-weight:600; color:var(--text-2); margin-bottom:12px;
  transition:color var(--transition); }
.rb-item { display:flex; align-items:center; gap:7px; margin-bottom:7px; }
.rb-day { font-size:10px; color:var(--text-2); width:52px; flex-shrink:0; transition:color var(--transition); }
.rb-track { flex:1; height:5px; background:var(--border); border-radius:3px; overflow:hidden; }
.rb-fill { height:100%; border-radius:3px; background:linear-gradient(90deg,var(--accent-blue),rgba(59,130,246,.45)); transition:width .8s ease; }
.rb-pcls { display:flex; justify-content:space-between; font-size:9px; color:var(--text-3); margin-top:5px; padding-left:59px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.toast {
  position:fixed; bottom:24px; left:50%; transform:translateX(-50%);
  background:#ef4444; color:#fff; font-size:13px;
  padding:10px 20px; border-radius:10px;
  box-shadow:0 4px 20px rgba(0,0,0,.35);
  opacity:0; pointer-events:none;
  transition:opacity .3s, transform .3s;
  z-index:999;
}
.toast.show { opacity:1; transform:translateX(-50%) translateY(-4px); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#loader {
  position:fixed; inset:0; background:var(--bg-body);
  display:flex; align-items:center; justify-content:center;
  z-index:998; transition:opacity .45s;
}
.spinner {
  width:44px; height:44px;
  border:3px solid var(--spinner-border);
  border-top-color:var(--accent-blue);
  border-radius:50%; animation:spin .75s linear infinite;
}
@keyframes spin { to{transform:rotate(360deg)} }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FOOTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.site-footer {
  max-width:1380px; margin:14px auto 0;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius:var(--radius-card);
  padding:20px 28px;
  transition: background var(--transition), border-color var(--transition);
}
.footer-inner {
  display:grid;
  grid-template-columns: 1fr auto 1fr;
  align-items:center; gap:16px;
}
/* Left â€” logo */
.footer-logo { display:flex; align-items:center; gap:8px; }
.footer-logo-ico {
  width:28px; height:28px; border-radius:7px;
  background:linear-gradient(135deg,#3b82f6,#8b5cf6);
  display:flex; align-items:center; justify-content:center;
  box-shadow:0 0 10px rgba(59,130,246,.3);
}
.footer-brand {
  font-size:15px; font-weight:700; letter-spacing:-.3px;
  color:var(--text-1);
}
.footer-brand .blue {
  background:linear-gradient(135deg,#3b82f6,#8b5cf6);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
}
.footer-copy {
  font-size:11px; color:var(--text-3); margin-top:3px;
  transition:color var(--transition);
}
.footer-powered {
  font-size:10px; color:var(--text-3); margin-top:2px;
  transition:color var(--transition);
}
.footer-powered a { color:var(--accent-blue); text-decoration:none; }
.footer-powered a:hover { opacity:.75; }

/* Centre â€” main taglines */
.footer-center { text-align:center; }
.footer-love {
  font-size:14px; font-weight:600; color:var(--text-1);
  transition:color var(--transition);
}
.footer-love .heart { color:#ef4444; animation:heartbeat 1.4s ease-in-out infinite; display:inline-block; }
@keyframes heartbeat { 0%,100%{transform:scale(1)} 14%{transform:scale(1.3)} 28%{transform:scale(1)} 42%{transform:scale(1.2)} }
.footer-love .author {
  background:linear-gradient(135deg,#3b82f6,#8b5cf6);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
  font-weight:700;
}
.footer-india {
  font-size:12px; color:var(--text-2); margin-top:5px;
  letter-spacing:.3px; transition:color var(--transition);
}
.footer-india .flag { font-size:14px; }
.footer-india .india-text {
  background:linear-gradient(90deg,#ff9933,#ffffff,#138808);
  -webkit-background-clip:text; -webkit-text-fill-color:transparent;
  font-weight:700;
}

/* Right â€” copyright */
.footer-right { text-align:right; }
.footer-yr {
  font-size:12px; color:var(--text-3);
  transition:color var(--transition);
}
.footer-rights {
  font-size:11px; color:var(--text-3); margin-top:3px;
  transition:color var(--transition);
}

/* page bottom breathing room */
.page-end { height:20px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANIMATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@keyframes fadeUp { from{opacity:0;transform:translateY(12px)} to{opacity:1;transform:translateY(0)} }
.card,.fc-day,.stat-c { animation:fadeUp .4s ease both; }
</style>
</head>
<body>

<div id="loader"><div class="spinner"></div></div>
<div class="toast" id="toast"></div>

<!-- â•â•â•â•â•â•â•â•â•â• NAVBAR â•â•â•â•â•â•â•â•â•â• -->
<nav class="navbar">
  <a class="nav-logo" href="#">
    <div class="logo-icon">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
        <circle cx="13" cy="8" r="4" fill="#fbbf24" opacity=".95"/>
        <line x1="13" y1="2" x2="13" y2="0" stroke="#fbbf24" stroke-width="1.5" stroke-linecap="round"/>
        <line x1="13" y1="22" x2="13" y2="20" stroke="#fbbf24" stroke-width="1.5" stroke-linecap="round"/>
        <line x1="3" y1="8" x2="1" y2="8" stroke="#fbbf24" stroke-width="1.5" stroke-linecap="round"/>
        <line x1="23" y1="8" x2="21" y2="8" stroke="#fbbf24" stroke-width="1.5" stroke-linecap="round"/>
        <path d="M8 17.5a4 4 0 0 1 0-8h.5A5.5 5.5 0 1 1 17 15.5H8z" fill="white" opacity=".95"/>
      </svg>
    </div>
    <span class="logo-text">Sky<span class="blue">Cast</span></span>
    <span class="logo-badge">Live</span>
  </a>

  <div class="nav-search-wrap" id="searchWrap">
    <span class="nav-search-icon">ğŸ”</span>
    <input type="text" class="nav-search-bar" id="searchInput"
      placeholder="Search any city, town or villageâ€¦"
      autocomplete="off" spellcheck="false"/>
    <button class="nav-search-clear" id="searchClear" title="Clear">âœ•</button>
    <button class="nav-search-btn" onclick="triggerSearch()">Search</button>
    <div class="nav-suggestions" id="suggestions"></div>
  </div>

  <div class="nav-right">
    <div class="nav-time" id="navTime">--:--:--</div>
    <button class="theme-btn" onclick="toggleTheme()">
      <span class="ico" id="themeIco">ğŸŒ™</span>
      <span id="themeLbl">Dark</span>
    </button>
  </div>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â• DASHBOARD â•â•â•â•â•â•â•â•â•â• -->
<div class="dashboard">

  <!-- MAIN CARD -->
  <div class="card main-card">
    <div class="main-header">
      <div class="loc-row">
        <span class="loc-pin">ğŸ“</span>
        <span class="loc-name" id="cityName">Loadingâ€¦</span>
      </div>
      <div class="updated" id="lastUpdated">Fetching weatherâ€¦</div>
    </div>

    <div class="weather-vis">
      <div class="wi-main" id="wiMain">ğŸŒ¤ï¸</div>
      <div>
        <div class="temp-big"><span id="tempVal">--</span>Â°C</div>
        <div class="desc-txt" id="descTxt">--</div>
        <div class="feels-txt" id="feelsTxt">--</div>
      </div>
      <div class="dots">
        <div class="dot dot-o"></div>
        <div class="dot dot-b"></div>
        <div class="dot dot-p"></div>
        <div class="dot dot-e"></div>
      </div>
    </div>

    <!-- Quick-switch cities -->
    <div class="city-tabs" id="cityTabs">
      <div class="ctab" id="ctab0" onclick="quickCity('Ajmer,IN',0)">
        <div class="ctab-name">Ajmer</div>
        <div class="ctab-tmp" id="ctab0t">--Â°C</div>
      </div>
      <div class="ctab active" id="ctab1" onclick="quickCity('Etah,IN',1)">
        <div class="ctab-name">Etah</div>
        <div class="ctab-tmp" id="ctab1t">--Â°C</div>
      </div>
      <div class="ctab" id="ctab2" onclick="quickCity('Agra,IN',2)">
        <div class="ctab-name">Agra</div>
        <div class="ctab-tmp" id="ctab2t">--Â°C</div>
      </div>
    </div>
  </div>

  <!-- FORECAST ROW -->
  <div class="fc-row" id="fcRow"></div>

  <!-- CHART -->
  <div class="card chart-card">
    <div class="sec-title">Weather Forecast</div>
    <div class="chart-wrap"><canvas id="fcChart"></canvas></div>
  </div>

  <!-- SUNRISE / SUNSET -->
  <div class="card sun-card">
    <div class="sun-title">Sunrise &amp; Sunset</div>
    <div class="sun-item">
      <div class="sun-ico">ğŸŒ…</div>
      <div>
        <div class="sun-lbl">Sunrise</div>
        <div class="sun-time" id="sunriseT">--</div>
      </div>
    </div>
    <div class="sun-item">
      <div class="sun-ico">ğŸŒ‡</div>
      <div>
        <div class="sun-lbl">Sunset</div>
        <div class="sun-time" id="sunsetT">--</div>
      </div>
    </div>
  </div>

  <!-- STATS -->
  <div class="stats-grid">
    <div class="stat-c"><div class="stat-lbl"><span class="stat-ico">ğŸ’§</span>Humidity</div><div class="stat-val"><span id="sHum">--</span><span class="stat-u"> %</span></div></div>
    <div class="stat-c"><div class="stat-lbl"><span class="stat-ico">ğŸ’¨</span>Wind Speed</div><div class="stat-val"><span id="sWind">--</span><span class="stat-u"> km/h</span></div></div>
    <div class="stat-c"><div class="stat-lbl"><span class="stat-ico">ğŸ‘ï¸</span>Visibility</div><div class="stat-val"><span id="sVis">--</span><span class="stat-u"> km</span></div></div>
    <div class="stat-c"><div class="stat-lbl"><span class="stat-ico">ğŸŒ¡ï¸</span>Pressure</div><div class="stat-val"><span id="sPress">--</span><span class="stat-u"> hPa</span></div></div>
    <div class="stat-c"><div class="stat-lbl"><span class="stat-ico">â˜€ï¸</span>UV Index</div><div class="stat-val"><span id="sUV">â€”</span></div></div>
    <div class="stat-c"><div class="stat-lbl"><span class="stat-ico">ğŸŒ§ï¸</span>Precipitation</div><div class="stat-val"><span id="sRain">0.00</span><span class="stat-u"> mm</span></div></div>
  </div>

  <!-- AQI -->
  <div class="card aqi-card">
    <div class="aqi-l">
      <div class="aqi-t">Air Quality</div>
      <div class="aqi-ring" id="aqiRing">
        <div class="aqi-status" id="aqiStat">Good</div>
        <div class="aqi-num" id="aqiNum">--</div>
      </div>
      <div class="aqi-cap" id="aqiCap">Fetching dataâ€¦</div>
    </div>
    <div class="aqi-r">
      <div><div class="aqi-s-hd"><div class="aqi-dot" style="background:#22c55e"></div><span class="aqi-s-nm">PM10</span></div><div class="aqi-s-v" id="aPM10">--</div></div>
      <div><div class="aqi-s-hd"><div class="aqi-dot" style="background:#eab308"></div><span class="aqi-s-nm">O3</span></div><div class="aqi-s-v" id="aO3">--</div></div>
      <div><div class="aqi-s-hd"><div class="aqi-dot" style="background:#22c55e"></div><span class="aqi-s-nm">SO2</span></div><div class="aqi-s-v" id="aSO2">--</div></div>
      <div><div class="aqi-s-hd"><div class="aqi-dot" style="background:#eab308"></div><span class="aqi-s-nm">PM2.5</span></div><div class="aqi-s-v" id="aPM25">--</div></div>
      <div><div class="aqi-s-hd"><div class="aqi-dot" style="background:#f97316"></div><span class="aqi-s-nm">CO</span></div><div class="aqi-s-v" id="aCO">--</div></div>
      <div><div class="aqi-s-hd"><div class="aqi-dot" style="background:#22c55e"></div><span class="aqi-s-nm">NO2</span></div><div class="aqi-s-v" id="aNO2">--</div></div>
    </div>
  </div>

  <!-- RAIN -->
  <div class="card rain-card">
    <div class="rain-title">Chances of Rain</div>
    <div id="rainBars"></div>
    <div class="rb-pcls"><span>0%</span><span>50%</span><span>100%</span></div>
  </div>

</div><!-- /.dashboard -->

<!-- â•â•â•â•â•â•â•â•â•â• FOOTER â•â•â•â•â•â•â•â•â•â• -->
<footer class="site-footer">
  <div class="footer-inner">

    <!-- Left: Logo + powered by -->
    <div class="footer-logo">
      <div class="footer-logo-ico">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
          <circle cx="13" cy="8" r="4" fill="#fbbf24" opacity=".9"/>
          <path d="M8 17.5a4 4 0 0 1 0-8h.5A5.5 5.5 0 1 1 17 15.5H8z" fill="white" opacity=".85"/>
        </svg>
      </div>
      <div>
        <div class="footer-brand">Sky<span class="blue">Cast</span></div>
        <div class="footer-copy">Â© <span id="footerYear"></span> SkyCast</div>
        <div class="footer-powered">Powered by <a href="https://openweathermap.org" target="_blank">OpenWeatherMap</a></div>
      </div>
    </div>

    <!-- Centre: Love + India -->
    <div class="footer-center">
      <div class="footer-love">
        Made with <span class="heart">â¤ï¸</span> by <span class="author">Gaurav Prajapati</span>
      </div>
      <div class="footer-india">
        <span class="flag">ğŸ‡®ğŸ‡³</span>
        &nbsp;Designed in&nbsp;<span class="india-text">INDIA</span>
      </div>
    </div>

    <!-- Right: copyright year + rights -->
    <div class="footer-right">
      <div class="footer-yr">All rights reserved</div>
      <div class="footer-rights">Version 2.0 Â· Live Data</div>
    </div>

  </div>
</footer>
<div class="page-end"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONFIG
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const KEY  = '42caf9e1dba95d9e37f6898f36f43e48';
const BASE = 'https://api.openweathermap.org/data/2.5/';
let chart    = null;
let curCity  = 'Etah,IN';
let isDark   = true;

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   THEME
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function toggleTheme() {
  isDark = !isDark;
  document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
  document.getElementById('themeIco').textContent  = isDark ? 'ğŸŒ™' : 'â˜€ï¸';
  document.getElementById('themeLbl').textContent  = isDark ? 'Dark' : 'Light';
  localStorage.setItem('skycast-theme', isDark ? 'dark' : 'light');
}
// Restore saved theme
(function() {
  const saved = localStorage.getItem('skycast-theme');
  if (saved === 'light') toggleTheme();
})();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CLOCK + FOOTER YEAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function tick() {
  const el = document.getElementById('navTime');
  if (el) el.textContent = new Date().toLocaleTimeString('en-IN',{hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:true});
}
setInterval(tick, 1000); tick();
document.getElementById('footerYear').textContent = new Date().getFullYear();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HELPERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function weatherEmoji(id, day) {
  if (id >= 200 && id < 300) return 'â›ˆï¸';
  if (id >= 300 && id < 400) return 'ğŸŒ¦ï¸';
  if (id >= 500 && id < 600) return id === 511 ? 'ğŸŒ¨ï¸' : id < 502 ? 'ğŸŒ§ï¸' : 'â›ˆï¸';
  if (id >= 600 && id < 700) return id < 611 ? 'â„ï¸' : 'ğŸŒ¨ï¸';
  if (id >= 700 && id < 800) return 'ğŸŒ«ï¸';
  if (id === 800) return day ? 'â˜€ï¸' : 'ğŸŒ™';
  if (id === 801) return day ? 'ğŸŒ¤ï¸' : 'ğŸŒ™';
  if (id === 802) return day ? 'â›…' : 'â˜ï¸';
  return 'â˜ï¸';
}
const dayCheck  = (dt,sr,ss) => dt > sr && dt < ss;
const fmtTime   = (ts,tz) => { const d=new Date((ts+tz)*1000); let h=d.getUTCHours(),m=String(d.getUTCMinutes()).padStart(2,'0'); const ap=h>=12?'PM':'AM'; h=h%12||12; return `${String(h).padStart(2,'0')}:${m} ${ap}`; };
const fmtDate   = (ts,tz) => { const d=new Date((ts+tz)*1000); return `Updated ${['Sun','Mon','Tue','Wed','Thu','Fri','Sat'][d.getUTCDay()]} ${d.getUTCDate()} ${['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'][d.getUTCMonth()]}`; };
const dayLabel  = (ts,tz) => ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'][new Date((ts+tz)*1000).getUTCDay()];
const dateKey   = (ts,tz) => { const d=new Date((ts+tz)*1000); return `${d.getUTCFullYear()}-${d.getUTCMonth()}-${d.getUTCDate()}`; };
const api       = url => fetch(url).then(r=>r.json());

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const toastEl = document.getElementById('toast');
function showToast(msg, color='#ef4444') {
  toastEl.textContent = msg; toastEl.style.background = color;
  toastEl.classList.add('show');
  setTimeout(() => toastEl.classList.remove('show'), 3000);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RENDER WEATHER DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function render(cur, fc, aqi) {
  const tz = cur.timezone, sr = cur.sys.sunrise, ss = cur.sys.sunset, dt = cur.dt;
  const isD = dayCheck(dt, sr, ss);

  // Main
  document.getElementById('cityName').textContent  = cur.name + ', ' + cur.sys.country;
  document.getElementById('lastUpdated').textContent = fmtDate(dt, tz);
  document.getElementById('tempVal').textContent    = Math.round(cur.main.temp);
  document.getElementById('descTxt').textContent    = cur.weather[0].description;
  document.getElementById('feelsTxt').textContent   = `Feels ${Math.round(cur.main.feels_like)}Â°C Â· Lo ${Math.round(cur.main.temp_min)}Â° Â· Hi ${Math.round(cur.main.temp_max)}Â°`;
  const wi = document.getElementById('wiMain');
  wi.textContent = weatherEmoji(cur.weather[0].id, isD);
  wi.className   = 'wi-main ' + (isD ? 'day' : 'night');

  // Sun
  document.getElementById('sunriseT').textContent = fmtTime(sr, tz);
  document.getElementById('sunsetT').textContent  = fmtTime(ss, tz);

  // Stats
  document.getElementById('sHum').textContent   = cur.main.humidity;
  document.getElementById('sWind').textContent  = Math.round(cur.wind.speed * 3.6);
  document.getElementById('sVis').textContent   = (cur.visibility / 1000).toFixed(1);
  document.getElementById('sPress').textContent = cur.main.pressure;
  document.getElementById('sRain').textContent  = cur.rain ? (cur.rain['1h'] || 0).toFixed(2) : '0.00';

  // Body background tint per day/night
  document.body.style.backgroundImage = isD
    ? 'radial-gradient(ellipse at 10% 20%,rgba(59,130,246,.05) 0%,transparent 50%),radial-gradient(ellipse at 90% 80%,rgba(249,115,22,.05) 0%,transparent 50%)'
    : 'radial-gradient(ellipse at 10% 20%,rgba(30,40,120,.09) 0%,transparent 50%),radial-gradient(ellipse at 90% 80%,rgba(20,10,80,.1) 0%,transparent 50%)';

  // Forecast row â€” best entry per day
  const dmap = {};
  fc.list.forEach(it => {
    const k = dateKey(it.dt, tz);
    const h = new Date((it.dt + tz) * 1000).getUTCHours();
    if (!dmap[k] || Math.abs(h-12) < Math.abs(new Date((dmap[k].dt+tz)*1000).getUTCHours()-12)) dmap[k] = it;
  });
  const fcRow = document.getElementById('fcRow');
  fcRow.innerHTML = '';
  Object.values(dmap).slice(0, 7).forEach((it, i) => {
    const same = fc.list.filter(x => dateKey(x.dt,tz) === dateKey(it.dt,tz));
    const lo = Math.round(Math.min(...same.map(x=>x.main.temp)));
    const hi = Math.round(Math.max(...same.map(x=>x.main.temp)));
    const e  = weatherEmoji(it.weather[0].id, dayCheck(it.dt, sr, ss));
    const el = document.createElement('div');
    el.className = 'fc-day' + (i===0?' active':'');
    el.innerHTML = `<span class="fc-icon">${e}</span><div class="fc-name">${dayLabel(it.dt,tz)}</div><div class="fc-tmp">${hi}Â°C</div><div class="fc-lo">${lo}Â°</div>`;
    fcRow.appendChild(el);
  });

  // Chart
  const dayData = {};
  fc.list.forEach(it => {
    const k = dateKey(it.dt, tz);
    if (!dayData[k]) dayData[k] = { t:[], name: dayLabel(it.dt,tz) };
    dayData[k].t.push(it.main.temp);
  });
  const labels=[], data=[];
  Object.values(dayData).slice(0,7).forEach(d => { labels.push(d.name); data.push(+(d.t.reduce((a,b)=>a+b,0)/d.t.length).toFixed(1)); });
  const ctx = document.getElementById('fcChart').getContext('2d');
  if (chart) chart.destroy();
  const g = ctx.createLinearGradient(0,0,0,148);
  g.addColorStop(0,'rgba(59,130,246,.25)'); g.addColorStop(1,'rgba(59,130,246,0)');
  chart = new Chart(ctx, {
    type:'line',
    data:{ labels, datasets:[{ data, borderColor:'#3b82f6', backgroundColor:g, borderWidth:2.5,
      pointBackgroundColor:'#3b82f6', pointBorderColor:'#fff', pointBorderWidth:2,
      pointRadius:5, pointHoverRadius:7, fill:true, tension:.4 }] },
    options:{ responsive:true, maintainAspectRatio:false,
      plugins:{ legend:{display:false},
        tooltip:{ backgroundColor:'#1c2030', titleColor:'#94a3b8', bodyColor:'#f1f5f9',
          borderColor:'rgba(255,255,255,.07)', borderWidth:1, padding:9,
          callbacks:{label:c=>` ${c.parsed.y}Â°C`} } },
      scales:{
        x:{ grid:{color:'rgba(128,128,128,.08)'}, ticks:{color:'#64748b',font:{size:10}}, border:{display:false} },
        y:{ grid:{color:'rgba(128,128,128,.08)'}, ticks:{color:'#64748b',font:{size:10},callback:v=>v+'Â°'}, border:{display:false} }
      }
    }
  });

  // Rain bars
  const rainMap = {};
  fc.list.forEach(it => {
    const k = dateKey(it.dt, tz);
    if (!rainMap[k]) rainMap[k] = { pops:[], name: dayLabel(it.dt,tz) };
    rainMap[k].pops.push(it.pop||0);
  });
  const rb = document.getElementById('rainBars');
  rb.innerHTML='';
  Object.values(rainMap).slice(0,7).forEach(d => {
    const pct = Math.round(d.pops.reduce((a,b)=>a+b,0)/d.pops.length*100);
    rb.innerHTML+=`<div class="rb-item"><div class="rb-day">${d.name}</div><div class="rb-track"><div class="rb-fill" style="width:${Math.max(pct,3)}%"></div></div></div>`;
  });

  // AQI
  if (aqi?.list?.[0]) {
    const c = aqi.list[0].components, qi = aqi.list[0].main.aqi;
    const labels=['','Good','Fair','Moderate','Poor','Very Poor'];
    const cols  =['','#22c55e','#84cc16','#eab308','#f97316','#ef4444'];
    const col = cols[qi]||'#22c55e';
    document.getElementById('aqiNum').textContent  = qi;
    document.getElementById('aqiStat').textContent = labels[qi]||'Good';
    ['aqiStat','aqiNum'].forEach(id=>document.getElementById(id).style.color=col);
    document.getElementById('aqiCap').textContent  = qi<=2?'Air is clean & healthy':qi<=3?'Air quality is acceptable':'Air quality is poor';
    const ring = document.getElementById('aqiRing');
    ring.style.background = `linear-gradient(var(--aqi-base),var(--aqi-base)) padding-box, linear-gradient(135deg,${col},${col}88) border-box`;
    ring.style.boxShadow  = `0 0 28px ${col}33`;
    document.getElementById('aPM10').textContent = Math.round(c.pm10||0);
    document.getElementById('aO3').textContent   = Math.round(c.o3||0);
    document.getElementById('aSO2').textContent  = Math.round(c.so2||0);
    document.getElementById('aPM25').textContent = Math.round(c.pm2_5||0);
    document.getElementById('aCO').textContent   = Math.round(c.co||0);
    document.getElementById('aNO2').textContent  = Math.round(c.no2||0);
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOAD CITY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function loadCity(city) {
  try {
    const cur = await api(`${BASE}weather?q=${city}&appid=${KEY}&units=metric`);
    if (cur.cod !== 200) { showToast(`âŒ "${city}" not found`); return; }
    const [fc, aqi] = await Promise.all([
      api(`${BASE}forecast?q=${city}&appid=${KEY}&units=metric`),
      api(`${BASE}air_pollution?lat=${cur.coord.lat}&lon=${cur.coord.lon}&appid=${KEY}`)
    ]);
    render(cur, fc, aqi);
  } catch(e) { showToast('âš ï¸ Network error. Try again.'); }
}

async function loadCityByLatLon(lat, lon, name, country) {
  try {
    const [cur, fc, aqi] = await Promise.all([
      api(`${BASE}weather?lat=${lat}&lon=${lon}&appid=${KEY}&units=metric`),
      api(`${BASE}forecast?lat=${lat}&lon=${lon}&appid=${KEY}&units=metric`),
      api(`${BASE}air_pollution?lat=${lat}&lon=${lon}&appid=${KEY}`)
    ]);
    if (cur.cod !== 200) { showToast('âŒ Could not load weather.'); return; }
    render(cur, fc, aqi);
  } catch(e) { showToast('âš ï¸ Network error. Try again.'); }
}

function showLoader(v) {
  const l = document.getElementById('loader');
  l.style.opacity = v ? '1' : '0';
  l.style.pointerEvents = v ? 'all' : 'none';
}

async function changeCity(city) {
  curCity = city;
  showLoader(true);
  await loadCity(city);
  showLoader(false);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   QUICK-SWITCH TABS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const tabCities = ['Ajmer,IN','Etah,IN','Agra,IN'];
async function quickCity(city, idx) {
  document.querySelectorAll('.ctab').forEach((t,i) => t.classList.toggle('active', i===idx));
  await changeCity(city);
}
async function loadTabTemp(city, id) {
  try {
    const d = await api(`${BASE}weather?q=${city}&appid=${KEY}&units=metric`);
    if (d.main) document.getElementById(id).textContent = Math.round(d.main.temp) + 'Â°C';
  } catch(e) {}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SEARCH ENGINE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const searchInput = document.getElementById('searchInput');
const searchClear = document.getElementById('searchClear');
const sugBox      = document.getElementById('suggestions');
let debounce = null, focusIdx = -1, lastRes = [];

function closeSug() { sugBox.classList.remove('open'); sugBox.innerHTML=''; focusIdx=-1; }

function setFocus(i) {
  const items = sugBox.querySelectorAll('.sug-item');
  items.forEach(el=>el.classList.remove('focused'));
  if (i>=0 && i<items.length) { items[i].classList.add('focused'); items[i].scrollIntoView({block:'nearest'}); }
  focusIdx = i;
}

function renderSug(res) {
  lastRes = res; focusIdx = -1;
  if (!res.length) { sugBox.innerHTML='<div class="sug-empty">ğŸ˜• No results â€” try a different spelling</div>'; sugBox.classList.add('open'); return; }
  sugBox.innerHTML = res.map((r,i) => `
    <div class="sug-item" data-idx="${i}">
      <span>ğŸ“</span>
      <div>
        <div class="sug-main">${r.name}</div>
        <div class="sug-sub">${[r.state,r.country].filter(Boolean).join(', ')}</div>
      </div>
      <span class="sug-country">${r.country||''}</span>
    </div>`).join('');
  sugBox.classList.add('open');
  sugBox.querySelectorAll('.sug-item').forEach(el => {
    el.addEventListener('mouseenter', ()=>setFocus(+el.dataset.idx));
    el.addEventListener('mousedown', e=>{ e.preventDefault(); pickResult(lastRes[+el.dataset.idx]); });
  });
}

async function doSearch(q) {
  if (q.length < 2) { closeSug(); return; }
  sugBox.innerHTML='<div class="sug-loading"><div class="sug-spin"></div> Searchingâ€¦</div>';
  sugBox.classList.add('open');
  try {
    const r = await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(q)}&limit=6&appid=${KEY}`).then(x=>x.json());
    if (Array.isArray(r)) renderSug(r); else closeSug();
  } catch(e) { closeSug(); showToast('âš ï¸ Search failed. Check connection.'); }
}

async function pickResult(r) {
  searchInput.value=''; searchClear.style.display='none'; closeSug();
  curCity = `${r.name},${r.country}`;
  showLoader(true);
  await loadCityByLatLon(r.lat, r.lon, r.name, r.country);
  showLoader(false);
}

function triggerSearch() {
  const q = searchInput.value.trim();
  if (!q) { searchInput.focus(); return; }
  closeSug(); searchInput.value=''; searchClear.style.display='none';
  changeCity(q);
}

searchInput.addEventListener('input', () => {
  const q = searchInput.value.trim();
  searchClear.style.display = q ? 'block' : 'none';
  clearTimeout(debounce);
  debounce = setTimeout(() => doSearch(q), 360);
});

searchInput.addEventListener('keydown', e => {
  const items = sugBox.querySelectorAll('.sug-item');
  if      (e.key==='ArrowDown')  { e.preventDefault(); setFocus(Math.min(focusIdx+1,items.length-1)); }
  else if (e.key==='ArrowUp')    { e.preventDefault(); setFocus(Math.max(focusIdx-1,0)); }
  else if (e.key==='Enter')      { e.preventDefault(); focusIdx>=0&&lastRes[focusIdx] ? pickResult(lastRes[focusIdx]) : triggerSearch(); }
  else if (e.key==='Escape')     { closeSug(); searchInput.blur(); }
});

searchClear.addEventListener('click', () => { searchInput.value=''; searchClear.style.display='none'; closeSug(); searchInput.focus(); });
document.addEventListener('click', e => { if (!document.getElementById('searchWrap').contains(e.target)) closeSug(); });

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
(async () => {
  await loadCity('Etah,IN');
  showLoader(false);
  loadTabTemp('Ajmer,IN','ctab0t');
  loadTabTemp('Etah,IN','ctab1t');
  loadTabTemp('Agra,IN','ctab2t');
})();

setInterval(() => loadCity(curCity), 600000);
</script>
</body>
</html>
